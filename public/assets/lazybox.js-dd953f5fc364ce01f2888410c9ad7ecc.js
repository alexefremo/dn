(function(){!function(e){var t,o,a,n,l,s;return a={overlay:!0,esc:!0,close:!0,modal:!0,opacity:.3,onTop:!1,speed:300,fixed:!1,cancelText:"Cancel",cancelClass:"button",submitText:"Ok",submitClass:"button"},n="<div id='lazybox'><div id='lazybox_body'></div></div>",t=e("#lazybox"),s=e("#lazybox_overlay"),o=e("#lazybox_close"),e.lazybox=function(t,o){return e.lazybox.show(t,o)},e.extend(e.lazybox,{settings:e.extend({},a),show:function(o,a){var n;return a=l(a),e("#lazybox_body").html(o),e.lazybox.center(a.onTop,a.fixed),n=a.onTop?"slideDown":"fadeIn",t[n](a.speed),a},close:function(e){var o;return e=e||a.speed,o=t.position().top-window.scrollY===0?"slideUp":"fadeOut",t[o](e),s.fadeOut(e+200)},center:function(o,a){var n;return a?(n=o?0:t.outerHeight()/2,20>n&&!o&&(n=20),t.css({"margin-left":-t.outerWidth()/2,"margin-top":-n,top:o?0:"49%",position:"fixed",left:"49%"})):(n=o?0:(e(window).height()-e("#lazybox").outerHeight())/2+e(window).scrollTop(),20>n&&!o&&(n=20),t.css({top:n,left:(e(window).width()-t.outerWidth())/2+e(window).scrollLeft(),position:"absolute",margin:0}))},confirm:function(t){var o,n;return n=e.extend(a,e.lazybox.settings),(o=t.data("confirm"))?(e.lazybox.show("<p>"+o+'</p><div class="lazy_buttons"></div>',{klass:"confirm"}),t.clone().attr("class",n.submitClass).removeAttr("data-confirm").text(n.submitText).appendTo(".lazy_buttons"),e(".lazy_buttons").append(" "),e("<a>",{href:"",text:n.cancelText,"class":n.cancelClass}).appendTo(".lazy_buttons"),!1):!0}}),e.fn.lazybox=function(o){return e(document).on("click",this.selector,function(a){var n,l,s,i;return n=e(a.currentTarget),l=n.attr("href"),s=new RegExp("\\.(png|jpg|jpeg|gif)(\\?.*)?$","i"),a.preventDefault(),l.match(s)?(i=new Image,i.onload=function(){var a,l;return o=e.lazybox.show(i,o),a=n.is(":last-child")?n.siblings("a[rel*=lazybox]:first"):n.next("a[rel*=lazybox]:first"),l=n.is(":first-child")?n.siblings("a[rel*=lazybox]:last"):n.prev("a[rel*=lazybox]:first"),a.length&&l.length?(e("#lazybox_body:not(:has(a#next_lazy_img))").append("<a id='prev_lazy_img' href=''><b>‹</b></a><a id='next_lazy_img' href=''><b>›</b></a>"),e("#next_lazy_img, #prev_lazy_img").bind("click",function(e){return e.preventDefault(),t.fadeOut(o.speed,function(){return"next_lazy_img"===e.currentTarget.id?a.click():l.click()})})):void 0},e(i).attr({"class":"lazy_img",src:l})):e.ajax({url:l,success:function(t){return e.lazybox.show(t,o)},error:function(){return e.lazybox.close(o.speed)}})})},l=function(l){return l=e.extend(e.extend({},a),e.lazybox.settings,l),l.overlay&&(e("body:not(:has(#lazybox_overlay))").append("<div id='lazybox_overlay'></div>"),s=e("#lazybox_overlay"),s.css({filter:"alpha(opacity="+100*l.opacity+")",opacity:l.opacity}).fadeIn(l.speed+200)),e("body:not(:has(#lazybox))").append(n),t=e("#lazybox"),l.klass?t.attr("class",l.klass):t.removeClass(),l.close?(t.not(":has(#lazybox_close)").prepend(e("<a id='lazybox_close' title='close'></a>")),o=e("#lazybox_close"),l.closeImg?o.attr("class","img").text(""):o.removeClass().text("×")):o.remove(),!l.modal&&l.overlay?s.bind("click",function(){return e.lazybox.close(l.speed)}):s.unbind(),e(document).keyup(function(t){return 27===t.keyCode&&l.esc?e.lazybox.close(l.speed):void 0}),t.on("click","#lazybox_close, .lazy_buttons a",function(t){return e.lazybox.close(l.speed),t.preventDefault()}),l}}(jQuery)}).call(this);